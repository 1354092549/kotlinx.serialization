<HTML>
<HEAD>
<meta charset="UTF-8">
<title>kotlinx.serialization.descriptors.SerialDescriptor - kotlinx-serialization</title>
<link rel="stylesheet" href="../../style.css">
</HEAD>
<BODY>
<a href="../../index.html">kotlinx-serialization</a>&nbsp;/&nbsp;<a href="../index.html">kotlinx.serialization.descriptors</a>&nbsp;/&nbsp;<a href="./index.html">SerialDescriptor</a><br/>
<br/>
<h1>SerialDescriptor</h1>
<a name="kotlinx.serialization.descriptors.SerialDescriptor"></a>
(common, jvm, native) <code><span class="keyword">interface </span><span class="identifier">SerialDescriptor</span></code>
<p>Serial descriptor is an inherent property of <a href="../../kotlinx.serialization/-k-serializer/index.html#kotlinx.serialization.KSerializer">KSerializer</a> that describes the structure of the serializable type.
The structure of the serializable type is not only the property of the type, but also of the serializer as well,
meaning that one type can have multiple descriptors that have completely different structure.</p>
<p>For example, the class <code>class Color(val rgb: Int)</code> can have multiple serializable representations,
such as <code>{"rgb": 255}</code>, <code>"#0000FF"</code>, <code>[0, 0, 255]</code> and <code>{"red": 0, "green": 0, "blue": 255}</code>.
Representations are determined by serializers and each such serializer has its own descriptor that identifies
each structure in a distinguishable and format-agnostic manner.</p>
<h3>Structure</h3>
<p>Serial descriptor is identified by its <a href="serial-name.html#kotlinx.serialization.descriptors.SerialDescriptor$serialName">name</a> and consists of kind, potentially empty set of
children elements and additional metadata.</p>
<ul><li><a href="serial-name.html#kotlinx.serialization.descriptors.SerialDescriptor$serialName">serialName</a> uniquely identifies the descriptor (and the corresponding serializer) for non-generic types.
For generic types, the actual type substitution is omitted from the string representation and the name
identifies the family of the serializers without type substitutions. However, type substitution is accounted
in <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/equals.html">equals</a> and <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/hash-code.html">hashCode</a> operations, meaning that descriptors of generic classes with the same name, but different type
parameters, are not equal to each other.
<a href="serial-name.html#kotlinx.serialization.descriptors.SerialDescriptor$serialName">serialName</a> is typically used to specify the type of the target class during serialization of polymorphic and sealed
classes, for observability and diagnostics.</li>
<li><a href="../-serial-kind/index.html#kotlinx.serialization.descriptors.SerialKind">Kind</a> defines what this descriptor represents: primitive, enum, object, collection et cetera.</li>
<li>Children elements are represented as serial descriptors as well and define the structure of the type's elements.</li>
<li>Metadata carries additional potentially useful information, such as <a href="#">nullability</a>, <a href="is-element-optional.html#kotlinx.serialization.descriptors.SerialDescriptor$isElementOptional(kotlin.Int)">optionality</a>
and <a href="get-element-annotations.html#kotlinx.serialization.descriptors.SerialDescriptor$getElementAnnotations(kotlin.Int)">serial annotations</a>.</li>
</ul>
<h3>Usages</h3>
<p>There are two general usages of the descriptors: THE serialization process and serialization introspection.</p>
<h4>Serialization</h4>
<p>Serial descriptor is used as bridge between decoders/encoders and serializers.
When asking for a next element, the serializer provides an expected descriptor to the decoder, and,
based on the descriptor content, decoder decides how to parse its input.
In JSON, for example, when the encoder is asked to encode the next element and this element
is a subtype of <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html">List</a>, the encoder receives a descriptor with <a href="../-structure-kind/-l-i-s-t.html#kotlinx.serialization.descriptors.StructureKind.LIST">StructureKind.LIST</a> and, based on that,
first writes an opening square bracket before writing the content of the list.</p>
<p>Serial descriptor <em>encapsulates</em> the structure of the data, so serializers can be free from
format-specific details. <code>ListSerializer</code> knows nothing about JSON and square brackets, providing
only the structure of the data and delegating encoding decision to the format itself.</p>
<h4>Introspection</h4>
<p>Another usage of a serial descriptor is type introspection without its serialization.
Introspection can be used to check, whether the given serializable class complies the
corresponding scheme and to generate JSON or ProtoBuf schema from the given class.</p>
<h3>Indices</h3>
<p>Serial descriptor API operates with children indices.
For the fixed-size structures, such as regular classes, index is represented by a value in
the range from zero to <a href="elements-count.html#kotlinx.serialization.descriptors.SerialDescriptor$elementsCount">elementsCount</a> and represent and index of the property in this class.
Consequently, primitives do not have children and their element count is zero.</p>
<p>For collections and maps, though, indices does not have fixed bound. Regular collections descriptors usually
have one element (<code>T</code>, maps have two, one for keys and one for values), but potentially unlimited
number of actual children values. Valid indices range is not known statically
and implementations of descriptor should provide consistent and unbounded names and indices.</p>
<p>In practice, for regular classes it is allowed to invoke <code>getElement*(index)</code> methods
with an index within <code>0 until elementsCount</code> range and element at the particular index corresponds to the
serializable property at the given position.
For collections and maps, index parameter for <code>getElement*(index)</code> methods is effectively bound
by the maximal number of collection/map elements.</p>
<h3>Thread-safety and mutability</h3>
<p>Serial descriptor implementation should be immutable and, thus, thread-safe.</p>
<h3>Equality and caching</h3>
<p>Serial descriptor can be used as a unique identifier for format-specific data or schemas and
this implies the following restrictions on its <code>equals</code> and <code>hashCode</code>:</p>
<ul><li></li>
</ul>
<p>An <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/equals.html">equals</a> implementation should use both <a href="serial-name.html#kotlinx.serialization.descriptors.SerialDescriptor$serialName">serialName</a> and elements structure.
Comparing <a href="#">elementDescriptors</a> directly is discouraged,
because it may cause a stack overflow error, e.g. if a serializable class <code>T</code> contains elements of type <code>T</code>.
To avoid it, a serial descriptor implementation should compare only descriptors
of class' type parameters, in a way that <code>serializer&lt;Box&lt;Int&gt;&gt;().descriptor != serializer&lt;Box&lt;String&gt;&gt;().descriptor</code>.
If type parameters are equal, descriptors structure should be compared by using children elements
descriptors' <a href="serial-name.html#kotlinx.serialization.descriptors.SerialDescriptor$serialName">serialName</a>s, which correspond to class names
(do not confuse with elements own names, which correspond to properties names); and/or other <a href="index.html#kotlinx.serialization.descriptors.SerialDescriptor">SerialDescriptor</a>
properties, such as <a href="kind.html#kotlinx.serialization.descriptors.SerialDescriptor$kind">kind</a>.
An example of <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/equals.html">equals</a> implementation:</p>
<pre><code>if (this === other) return true
if (other::class != this::class) return false
if (serialName != other.serialName) return false
if (!typeParametersAreEqual(other)) return false
if (this.elementDescriptors().map { it.serialName } != other.elementDescriptors().map { it.serialName }) return false
return true
</code></pre>
<p><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/hash-code.html">hashCode</a> implementation should use the same properties for computing the result.</p>
<h3>User-defined serial descriptors</h3>
<p>The best way to define a custom descriptor is to use <a href="index.html#kotlinx.serialization.descriptors.SerialDescriptor">SerialDescriptor</a> builder function, where
for each serializable property corresponding element is declared.</p>
<p>Example:</p>
<pre><code>// Class with custom serializer and custom serial descriptor
class Data(
    val intField: Int, // This field is ignored by custom serializer
    val longField: Long, // This field is written as long, but in serialized form is named as "_longField"
    val stringList: List&lt;String&gt; // This field is written as regular list of strings
)

// Descriptor for such class:
SerialDescriptor("my.package.Data") {
    // intField is deliberately ignored by serializer -- not present in the descriptor as well
    element&lt;Long&gt;("_longField") // longField is named as _longField
    element("stringField", listDescriptor&lt;String&gt;())
}
</code></pre>
<p>For a classes that are represented as a single primitive value, <a href="../-primitive-serial-descriptor.html#kotlinx.serialization.descriptors$PrimitiveSerialDescriptor(kotlin.String, kotlinx.serialization.descriptors.PrimitiveKind)">PrimitiveSerialDescriptor</a> builder function can be used instead.</p>
<h3>Not stable for inheritance</h3>
<p><code>SerialDescriptor</code> interface is not stable for inheritance in 3rd party libraries, as new methods
might be added to this interface or contracts of the existing methods can be changed.
This interface is safe to build using <a href="../build-class-serial-descriptor.html#kotlinx.serialization.descriptors$buildClassSerialDescriptor(kotlin.String, kotlin.Array((kotlinx.serialization.descriptors.SerialDescriptor)), kotlin.Function1((kotlinx.serialization.descriptors.ClassSerialDescriptorBuilder, kotlin.Unit)))">buildClassSerialDescriptor</a> and <a href="../-primitive-serial-descriptor.html#kotlinx.serialization.descriptors$PrimitiveSerialDescriptor(kotlin.String, kotlinx.serialization.descriptors.PrimitiveKind)">PrimitiveSerialDescriptor</a>,
and is safe to delegate implementation to existing instances.</p>
<h3>Properties</h3>
<table>
<tbody>
<tr>
<td>
(common, jvm, native) 
<h4><a href="annotations.html">annotations</a></h4>
</td>
<td>
<p>Returns serial annotations of the associated class.
Serial annotations can be used to specify an additional metadata that may be used during serialization.
Only annotations marked with <a href="../../kotlinx.serialization/-serial-info/index.html#kotlinx.serialization.SerialInfo">SerialInfo</a> are added to the resulting list.</p>
<code><span class="keyword">open</span> <span class="keyword">val </span><span class="identifier">annotations</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html"><span class="identifier">List</span></a><span class="symbol">&lt;</span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-annotation/index.html"><span class="identifier">Annotation</span></a><span class="symbol">&gt;</span></code></td>
</tr>
<tr>
<td>
(common, jvm, native) 
<h4><a href="elements-count.html">elementsCount</a></h4>
</td>
<td>
<p>The number of elements this descriptor describes, besides from the class itself.
<a href="elements-count.html#kotlinx.serialization.descriptors.SerialDescriptor$elementsCount">elementsCount</a> describes the number of <strong>semantic</strong> elements, not the number
of actual fields/properties in the serialized form, even though they frequently match.</p>
<code><span class="keyword">abstract</span> <span class="keyword">val </span><span class="identifier">elementsCount</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><span class="identifier">Int</span></a></code></td>
</tr>
<tr>
<td>
(common, jvm, native) 
<h4><a href="is-nullable.html">isNullable</a></h4>
</td>
<td>
<p>Whether the descriptor describes nullable element.
Returns <code>true</code> if associated serializer can serialize/deserialize nullable elements of the described type.</p>
<code><span class="keyword">open</span> <span class="keyword">val </span><span class="identifier">isNullable</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></td>
</tr>
<tr>
<td>
(common, jvm, native) 
<h4><a href="kind.html">kind</a></h4>
</td>
<td>
<p>The kind of the serialized form that determines <strong>the shape</strong> of the serialized data.
Formats use serial kind to add and parse serializer-agnostic metadata to the result.</p>
<code><span class="keyword">abstract</span> <span class="keyword">val </span><span class="identifier">kind</span><span class="symbol">: </span><a href="../-serial-kind/index.html"><span class="identifier">SerialKind</span></a></code></td>
</tr>
<tr>
<td>
(common, jvm, native) 
<h4><a href="serial-name.html">serialName</a></h4>
</td>
<td>
<p>Serial name of the descriptor that identifies pair of the associated serializer and target class.</p>
<code><span class="keyword">abstract</span> <span class="keyword">val </span><span class="identifier">serialName</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a></code></td>
</tr>
</tbody>
</table>
<h3>Functions</h3>
<table>
<tbody>
<tr>
<td>
(common, jvm, native) 
<h4><a href="get-element-annotations.html">getElementAnnotations</a></h4>
</td>
<td>
<p>Returns serial annotations of the child element at the given <a href="get-element-annotations.html#kotlinx.serialization.descriptors.SerialDescriptor$getElementAnnotations(kotlin.Int)/index">index</a>.
This method differs from <code>getElementDescriptor(index).annotations</code> by reporting only
declaration-specific annotations:</p>
<code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">getElementAnnotations</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.descriptors.SerialDescriptor$getElementAnnotations(kotlin.Int)/index">index</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><span class="identifier">Int</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html"><span class="identifier">List</span></a><span class="symbol">&lt;</span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-annotation/index.html"><span class="identifier">Annotation</span></a><span class="symbol">&gt;</span></code></td>
</tr>
<tr>
<td>
(common, jvm, native) 
<h4><a href="get-element-descriptor.html">getElementDescriptor</a></h4>
</td>
<td>
<p>Retrieves the descriptor of the child element for the given <a href="get-element-descriptor.html#kotlinx.serialization.descriptors.SerialDescriptor$getElementDescriptor(kotlin.Int)/index">index</a>.
For the property of type <code>T</code> on the position <code>i</code>, <code>getElementDescriptor(i)</code> yields the same result
as for <code>T.serializer().descriptor</code>, if the serializer for this property is not explicitly overridden
with <code>@Serializable(with = ...</code>)`, <a href="../../kotlinx.serialization/-polymorphic/index.html#kotlinx.serialization.Polymorphic">Polymorphic</a> or <a href="../../kotlinx.serialization/-contextual/index.html#kotlinx.serialization.Contextual">Contextual</a>.
This method can be used to completely introspect the type that the current descriptor describes.</p>
<code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">getElementDescriptor</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.descriptors.SerialDescriptor$getElementDescriptor(kotlin.Int)/index">index</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><span class="identifier">Int</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="./index.html"><span class="identifier">SerialDescriptor</span></a></code></td>
</tr>
<tr>
<td>
(common, jvm, native) 
<h4><a href="get-element-index.html">getElementIndex</a></h4>
</td>
<td>
<p>Returns an index in the children list of the given element by its name or <a href="../../kotlinx.serialization.encoding/-composite-decoder/-u-n-k-n-o-w-n_-n-a-m-e.html#kotlinx.serialization.encoding.CompositeDecoder.Companion$UNKNOWN_NAME">CompositeDecoder.UNKNOWN_NAME</a>
if there is no such element.
The resulting index, if it is not <a href="../../kotlinx.serialization.encoding/-composite-decoder/-u-n-k-n-o-w-n_-n-a-m-e.html#kotlinx.serialization.encoding.CompositeDecoder.Companion$UNKNOWN_NAME">CompositeDecoder.UNKNOWN_NAME</a>, is guaranteed to be usable with <a href="get-element-name.html#kotlinx.serialization.descriptors.SerialDescriptor$getElementName(kotlin.Int)">getElementName</a>.</p>
<code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">getElementIndex</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.descriptors.SerialDescriptor$getElementIndex(kotlin.String)/name">name</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><span class="identifier">Int</span></a></code></td>
</tr>
<tr>
<td>
(common, jvm, native) 
<h4><a href="get-element-name.html">getElementName</a></h4>
</td>
<td>
<p>Returns a positional name of the child at the given <a href="get-element-name.html#kotlinx.serialization.descriptors.SerialDescriptor$getElementName(kotlin.Int)/index">index</a>.
Positional name represents a corresponding property name in the class, associated with
the current descriptor.</p>
<code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">getElementName</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.descriptors.SerialDescriptor$getElementName(kotlin.Int)/index">index</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><span class="identifier">Int</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a></code></td>
</tr>
<tr>
<td>
(common, jvm, native) 
<h4><a href="is-element-optional.html">isElementOptional</a></h4>
</td>
<td>
<p>Whether the element at the given <a href="is-element-optional.html#kotlinx.serialization.descriptors.SerialDescriptor$isElementOptional(kotlin.Int)/index">index</a> is optional (can be absent is serialized form).
For generated descriptors, all elements that have a corresponding default parameter value are
marked as optional. Custom serializers can treat optional values in a serialization-specific manner
without default parameters constraint.</p>
<code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">isElementOptional</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.descriptors.SerialDescriptor$isElementOptional(kotlin.Int)/index">index</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html"><span class="identifier">Int</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></td>
</tr>
</tbody>
</table>
</BODY>
</HTML>
